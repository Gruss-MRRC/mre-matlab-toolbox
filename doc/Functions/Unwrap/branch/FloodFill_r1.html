<!DOCTYPE html>
<html lang="en">
<head>

    <title>FloodFill_r1</title>
    <link rel="shortcut icon" href="../images/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="../css/manpage_stylesheet.css" />
	<link type="text/css" rel="stylesheet" href="../../../m2html.css" />
</head>
<body>
	<main>
		<header>
			<div id="_path"><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">Functions</a> &gt; <a href="#">Unwrap</a> &gt; <a href="index.html">branch</a> &gt; FloodFill_r1.m</div>
		</header>
		<article>
<h1>FloodFill_r1</h1>
    <p><b>function IM_unwrapped = FloodFill2(IM_phase, IM_mag, branch_cuts, IM_mask, colref, rowref)</b></p>
    <p>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 FloodFill.m implements 2D Goldstein branch cut phase unwrapping algorithm.
 function [IM_unwrapped, rowref, colref] = FloodFill(IM_phase_rads, IM_mag, branch_cuts, IM_mask, colref, rowref)
 It unwraps the phase image, avoiding all branch cuts.
 It can also be used to unwrap phases in cases when there are no branch cuts.

 Inputs:
  IM_phase_rads = 2D array of wrapped phases (rads)
  IM_mag        = 2D array of magnitudes
  branch_cuts   = 2D array of identifying branch_cut locations,
                (Compute using BranchCuts.m or BranchCuts2.m)
 IM_mask is not used here, but it is used in GoldsteinUnwrap2D2.m for the plots.
 colref, rowref = the coordinates of the refernce point,
                  which is the starting point for the unwrapping algorithm.
 Outputs:
  IM_unwrapped  = the 2D array of unwrapped phases (rads)

 References:
 1. R. M. Goldstein, H. A. Zebken, and C. L. Werner, “Satellite radar interferometry:
    Two-dimensional phase unwrapping,” Radio Sci., vol. 23, no. 4, pp. 713–720, 1988.
 2. D. C. Ghiglia and M. D. Pritt, Two-Dimensional Phase Unwrapping:
    Theory, Algorithms and Software. New York: Wiley-Interscience, 1998.

 Created by B.S. Spottiswoode on 12/10/2004
 2010/07/23  Carey Smith
             1. Added colref, rowref as input arguments.
                Moved the logic to chose the reference point from here
                GoldsteinUnwrap2D.m, in order to be similar to the
                Quality Guided routines.
             2. Implemented Itoh's in-lin method to remove 2*pi jumps
                (rather than calling unwrap).
             3. When there are 2 or more valid neighbors, use the one with the 
                largest magnitude for determining the unwrapped phase.
                (Previous code re-computed the unwrapped phase for each valid 
                neighbor, over-writing the previous computation each time.)
             4. Implemented Content Advisor's recommended usage of &amp; vs. &amp;&amp;
                and | vs. ||
             5. Initialzed the output unwrapped version of the phase = nan,
                rather than zero.  This allows us to distinguish between valid 
                zeroes and pixels that were not computed.
                (In plots, the nan's show up as the minimum value.)
                If you prefer zeros, the original line can be uncommented 
                or you can reset the nan vaules at the end.
             6. Allow the edge pixels to be unwrapped.
             7. Modified the logic so that it shouldn't get &quot;stuck&quot;.
                Check if r_adjoin is empty.  If so, then we are done for that
                set of points, so break the inner loop.
                Also, verify that the same set of points are being re-tried,
                not just that the length of the vector is the same.
                if there are no valid adjoining pixels, set 
                adjoin(r_active,c_active) = 0, so that this point isn't re-tried.
             8. Added logic to skip the branch-cut block, when there are no
                branch cuts.
             9. Added additional comments and error-catching logic.
             10.Changed i to ii and j to jj to avoid redefining the imaginary
                units
 2010/07/26  Carey Smith: Made a speed improvement
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</p>

<h3>References</h3>
    <h4>Calls</h4>
      <ul>
        
      </ul>
    <h4>Called by</h4>
      <ul>
        
        <li><a href="GoldsteinUnwrap2D_r1.html" class="code" title="function im_unwrapped = GoldsteinUnwrap2D_r1(im_mag,im_phase)">GoldsteinUnwrap2D_r1</a>	GoldsteinUnwrap2D is a script to demonstrate the 2D Goldstein branch cut phase unwrapping algorithm.</li>
      </ul>
      <!-- crossreference -->

      

      

      
      </article>
      <footer>
		  <address>Generated on Fri 05-Dec-2014 12:12:37 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
	  </footer>
	</main>
</body>
</html>